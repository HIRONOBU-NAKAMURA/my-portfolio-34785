<% provide(:title, "一覧") %>
<% if user_signed_in? %>
  <div class="row">
    <aside class="col-md-4">
      <section class="user_info">
        <%= link_to gravatar_for(current_user), my_account_path(current_user) %>
        <h1><%= current_user.name %></h1>
        <span><%= link_to "プロフィールページへ", my_account_path(current_user) %></span>
        <span><%= pluralize(current_user.posts.count, "post") %></span>
      </section>
      <section class="post_form">
        <%= form_with(model: @post, local: true) do |f| %>
        <div class="field">
          <%= f.text_area :content, placeholder: "新規投稿をしよう" %>
        </div>
        <%= f.submit "投稿", class: "btn btn-primary" %>
        <span class="image">
          <%= f.file_field :image , accept: "image/jpeg,image/gif,image/png"%>
        </span>
      <% end %>
        <script type="text/javascript">
          $("#post_image").bind("change", function() {
            var size_in_megabytes = this.files[0].size/1024/1024;
            if (size_in_megabytes > 5) {
              alert("ファイルサイズは5MBです。 小さいファイルを選択してください。");
              $("#post_image").val("");
            }
          });
        </script>
      </section>
    </aside>
    <div class="col-md-8">
      <h3 style="text-align: center;">投稿履歴</h3>
        <% if @feed_items.any? %>
          <ol class="posts">
            <%= render @feed_items %>
          </ol>
          <%= will_paginate @feed_items,params: { controller: :static_pages,action: :index } , previous_label: '&lt 前へ', next_label: '次へ &gt'%>
        <% end %>
    </div>
  </div>
<% else %>
<div class="center jumbotron">
  <h1>Rails 勉強会</h1>

  <h2 class="line-set">
    Rails勉強会とはRailsを勉強し始めた方や、Railsが好きな方、RubyやRailsを学びたい方が自分の考えや学習記録をアウトプットするための学習コミュニティーアプリケーションです！みんなでレベルアップをしましょう！！
  </h2>

  <%= link_to "新規登録はこちら", new_user_registration_path, class: "btn btn-lg btn-primary" %>
</div>
<% end %>

<%#= link_to image_tag("rails.svg", alt: "Rails logo", width: "200px"),
                      "https://rubyonrails.org/" %>
